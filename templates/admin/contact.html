{% extends "admin/base.html" %} {% block content %}
<div class="bg-[var(--bg-color)] pt-1 sm:pt-2 lg:pt-3 overflow-hidden">
  <div class="max-w-2xl mx-auto">
    <!-- Header Section -->
    <div class="text-center mb-4">
      <div class="flex justify-center mb-6">
        <div
          class="p-4 bg-[var(--sec-bg-color)] rounded-full border border-[var(--border-color)]"
        >
          <i data-lucide="mail" class="w-8 h-8 text-[var(--main-color)]"></i>
        </div>
      </div>
      <h1 class="text-4xl font-bold text-[var(--white)] mb-2">Get in Touch</h1>
      <p class="text-[var(--sec-text)] text-lg">
        Have a question or want to work together? We'd love to hear from you.
      </p>
    </div>
    <!-- Contact Form -->
    <div
      class="bg-[var(--sec-bg-color)] rounded-xl border border-[var(--border-color)] p-8 shadow-2xl"
    >
      <!-- Success Message -->
      <div
        id="success-message"
        class="hidden bg-green-900/50 border border-green-700 text-green-200 px-4 py-3 rounded mb-6"
      >
        <div class="flex items-center">
          <i data-lucide="check-circle" class="w-5 h-5 mr-2"></i>
          <span class="text-sm"
            >Your message has been sent successfully! We'll get back to you
            soon.</span
          >
        </div>
      </div>
      <!-- Error Message -->
      <div
        id="error-message"
        class="hidden bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded mb-6"
      >
        <div class="flex items-center">
          <i data-lucide="x-circle" class="w-5 h-5 mr-2"></i>
          <span class="text-sm"></span>
        </div>
      </div>
      <form id="contact-form" class="space-y-2">
        <!-- Name Field -->
        <div class="group">
          <label
            for="name"
            class="flex items-center text-[var(--white)] font-medium mb-2"
          >
            <i
              data-lucide="user"
              class="w-4 h-4 mr-2 text-[var(--main-color)]"
            ></i>
            Full Name
          </label>
          <input
            type="text"
            id="name"
            name="name"
            {%
            if
            admin
            %}value="{{ admin.username }}"
            {%
            endif
            %}
            required
            class="w-full px-4 py-3 bg-[var(--bg-color)] border border-[var(--border-color)] rounded-lg text-[var(--white)] placeholder-[var(--sec-text)] focus:outline-none focus:border-[var(--main-color)] focus:ring-2 focus:ring-[var(--main-color)]/20 transition-all duration-200"
            placeholder="Enter your full name"
          />
        </div>
        <!-- Email Field -->
        <div class="group">
          <label
            for="email"
            class="flex items-center text-[var(--white)] font-medium mb-2"
          >
            <i
              data-lucide="mail"
              class="w-4 h-4 mr-2 text-[var(--main-color)]"
            ></i>
            Email Address
          </label>
          <input
            type="email"
            id="email"
            name="email"
            {%
            if
            admin
            %}value="{{ admin.email }}"
            {%
            endif
            %}
            required
            class="w-full px-4 py-3 bg-[var(--bg-color)] border border-[var(--border-color)] rounded-lg text-[var(--white)] placeholder-[var(--sec-text)] focus:outline-none focus:border-[var(--main-color)] focus:ring-2 focus:ring-[var(--main-color)]/20 transition-all duration-200"
            placeholder="Enter your email address"
          />
        </div>
        <!-- Phone Field -->
        <div class="group">
          <label
            for="phone"
            class="flex items-center text-[var(--white)] font-medium mb-2"
          >
            <i
              data-lucide="phone"
              class="w-4 h-4 mr-2 text-[var(--main-color)]"
            ></i>
            Phone Number
          </label>
          <input
            type="tel"
            id="phone"
            name="phone"
            required
            {%
            if
            admin
            %}value="{{ admin.phone }}"
            {%
            endif
            %}
            class="w-full px-4 py-3 bg-[var(--bg-color)] border border-[var(--border-color)] rounded-lg text-[var(--white)] placeholder-[var(--sec-text)] focus:outline-none focus:border-[var(--main-color)] focus:ring-2 focus:ring-[var(--main-color)]/20 transition-all duration-200"
            placeholder="Enter your phone number"
          />
        </div>
        <!-- Subject Field -->
        <div class="group">
          <label
            for="subject"
            class="flex items-center text-[var(--white)] font-medium mb-2"
          >
            <i
              data-lucide="tag"
              class="w-4 h-4 mr-2 text-[var(--main-color)]"
            ></i>
            Subject
          </label>
          <input
            type="text"
            id="subject"
            name="subject"
            required
            class="w-full px-4 py-3 bg-[var(--bg-color)] border border-[var(--border-color)] rounded-lg text-[var(--white)] placeholder-[var(--sec-text)] focus:outline-none focus:border-[var(--main-color)] focus:ring-2 focus:ring-[var(--main-color)]/20 transition-all duration-200"
            placeholder="What's this about?"
          />
        </div>
        <!-- Message Field -->
        <div class="group">
          <label
            for="message"
            class="flex items-center text-[var(--white)] font-medium mb-2"
          >
            <i
              data-lucide="message-square"
              class="w-4 h-4 mr-2 text-[var(--main-color)]"
            ></i>
            Message
          </label>
          <textarea
            id="message"
            name="message"
            rows="6"
            required
            class="w-full px-4 py-3 bg-[var(--bg-color)] border border-[var(--border-color)] rounded-lg text-[var(--white)] placeholder-[var(--sec-text)] focus:outline-none focus:border-[var(--main-color)] focus:ring-2 focus:ring-[var(--main-color)]/20 transition-all duration-200 resize-vertical"
            placeholder="Tell us more about your inquiry..."
          ></textarea>
        </div>
        <!-- Submit Button -->
        <div class="pt-4">
          <button
            type="submit"
            id="submit-btn"
            class="w-full bg-[var(--main-color)] hover:bg-[var(--main-color)]/90 text-[var(--white)] font-semibold py-4 px-6 rounded-lg transition-all duration-200 flex items-center justify-center space-x-2 group relative overflow-hidden"
          >
            <span class="flex items-center space-x-2">
              <i
                data-lucide="send"
                class="w-5 h-5 transition-transform group-hover:translate-x-1"
              ></i>
              <span>Send Message</span>
            </span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
<!-- Custom Styles for better form interactions -->
<style>
  .group:focus-within label {
    color: var(--main-color);
  }
</style>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const contactForm = document.getElementById("contact-form");
    const submitBtn = document.getElementById("submit-btn");
    const successMessage = document.getElementById("success-message");
    const errorMessage = document.getElementById("error-message");
    const errorText = errorMessage.querySelector("span");

    // Form inputs for clearing
    const formInputs = [
      document.getElementById("name"),
      document.getElementById("email"),
      document.getElementById("phone"),
      document.getElementById("subject"),
      document.getElementById("message"),
    ];

    contactForm.addEventListener("submit", function (e) {
      e.preventDefault();

      // Hide any existing messages
      hideMessages();

      // Validate form
      const formData = new FormData(contactForm);
      const data = Object.fromEntries(formData);

      // Basic validation
      if (
        !data.name ||
        !data.email ||
        !data.phone ||
        !data.subject ||
        !data.message
      ) {
        showError("Please fill in all required fields");
        return;
      }

      // Email validation
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(data.email)) {
        showError("Please enter a valid email address");
        return;
      }

      // Add loading state
      submitBtn.disabled = true;
      submitBtn.innerHTML = `
        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-[var(--white)] inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        Sending...
      `;

      // Send form data
        console.log(data)
      fetch("/admin/contact", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(data),
      })
        .then((response) => {
          if (response.ok) {
            return response.json().then((data) => {
              showSuccess();
              clearForm();
            });
          } else {
            return response.json().then((data) => {
              showError(
                data.error || "Failed to send message. Please try again.",
              );
            });
          }
        })
        .catch((error) => {
          console.error("Error:", error);
          showError("An error occurred. Please try again.");
        })
        .finally(() => {
          // Reset button state
          submitBtn.disabled = false;
          submitBtn.innerHTML = `
            <span class="flex items-center space-x-2">
              <i data-lucide="send" class="w-5 h-5 transition-transform group-hover:translate-x-1"></i>
              <span>Send Message</span>
            </span>
          `;
        });
    });

    function showSuccess() {
      successMessage.classList.remove("hidden");

      // Auto-hide success message after 5 seconds
      setTimeout(() => {
        successMessage.classList.add("hidden");
      }, 5000);
    }

    function showError(message) {
      errorText.textContent = message;
      errorMessage.classList.remove("hidden");

      // Auto-hide error after 5 seconds
      setTimeout(() => {
        errorMessage.classList.add("hidden");
      }, 5000);
    }

    function hideMessages() {
      successMessage.classList.add("hidden");
      errorMessage.classList.add("hidden");
    }

    function clearForm() {
      // Clear all form fields except pre-filled admin data
      formInputs.forEach((input) => {
        if (input && !input.hasAttribute("value")) {
          input.value = "";
        } else if (input && input.id === "subject") {
          // Always clear subject
          input.value = "";
        } else if (input && input.id === "message") {
          // Always clear message
          input.value = "";
        } else if (
          input &&
          input.id === "phone" &&
          !input.getAttribute("value")
        ) {
          // Clear phone if no pre-filled value
          input.value = "";
        }
      });
    }

    // Hide messages when user starts typing
    formInputs.forEach((input) => {
      if (input) {
        input.addEventListener("input", function () {
          hideMessages();
        });
      }
    });

    // Handle enter key on form inputs (except textarea)
    formInputs.forEach((input) => {
      if (input && input.tagName !== "TEXTAREA") {
        input.addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            e.preventDefault();
            contactForm.dispatchEvent(new Event("submit"));
          }
        });
      }
    });
  });
</script>
{% endblock %}
