<html>
  <head>
    <title>VAPI</title>
    <meta charset="UTF-8" />
    <style>
      .vapi-btn-pill
      {
        background: #001f33 !important;
        color: #ff5800 !important;
        font-size: 15px;
        font-style: normal;
        font-weight: 600;
        line-height: 0;
        letter-spacing: -0.32px;
        cursor: pointer;
        box-shadow: none !important;
        padding: 0 !important;
        transform: none !important;
      }
      #vapi-icon-container {
        display: none;
      }
      #vapi-title::after {
        content: '';
        display: inline-block;
        vertical-align: middle;
        width: 1em;
        height: 1em;
        margin-left: 0.3em;
        background: url('speak.svg') no-repeat center center;
        background-size: contain;
      }
      .vapi-btn {
        position: "relative";
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        width: fit-content;
        
      }
    </style>
  </head>
  <body>
    

    <script>
      const assistant = ""; // Replace with your assistant ID
      const apiKey = "6e062b80-ad6b-469f-9ada-"; // Replace with your API key

      var vapiInstance = null;

      const buttonConfig = {
        position: "top-left", // "bottom" | "top" | "left" | "right" | "top-right" | "top-left" | "bottom-left" | "bottom-right"
        offset: "10px", // decide how far the button should be from the edge
        width: "20px", // min-width of the button
        height: "30px", // height of the button
        idle: {
          // button state when the call is not active.
          type: "pill", // or "round"
          title: 'Or talk to AI Operator ', // only required in case of Pill
          subtitle: " ", // only required in case of pill
          icon: `https://unpkg.com/lucide-static@0.321.0/icons/phone.svg`,
        },
        loading: {
          // button state when the call is connecting
          type: "pill", // or "round"
          title: "Connecting...", // only required in case of Pill
          subtitle: " ", // only required in case of pill
          icon: `https://unpkg.com/lucide-static@0.321.0/icons/loader-2.svg`,
        },
        active: {
          // button state when the call is in progress or active.
          type: "pill", // or "round"
          title: "Call is in progress...Click to cancel", // only required in case of Pill
          subtitle: " ", // only required in case of pill
          icon: `https://unpkg.com/lucide-static@0.321.0/icons/phone-off.svg`,
        },
      };

      (function (d, t) {
        var g = document.createElement(t),
          s = d.getElementsByTagName(t)[0];
        g.src =
          "https://cdn.jsdelivr.net/gh/VapiAI/html-script-tag@latest/dist/assets/index.js";
        g.defer = true;
        g.async = true;
        s.parentNode.insertBefore(g, s);

        g.onload = function () {
          const vapi = window.vapiSDK.run({
            apiKey: apiKey, // required
            assistant: assistant, // required
            config: buttonConfig, // optional
          });

          if (vapi) {
            // Extend more using vapi
            window.vapiSDK.vapi = vapi;
            vapiInstance = vapi;

            vapiInstance.on("speech-start", () => {
              alert("Speech has started");
              console.log("Speech has started");
            });

            vapiInstance.on("speech-end", () => {
              console.log("Speech has ended");
            });

            vapiInstance.on("call-start", () => {
              console.log("Call has started");
            });

            vapiInstance.on("call-end", () => {
              console.log("Call has stopped");
            });

            vapiInstance.on("volume-level", (volume) => {
              console.log(`Assistant volume level: ${volume}`);
            });

            // Function calls and transcripts will be sent via messages
            vapiInstance.on("message", (message) => {
              console.log(message);
            });

            vapiInstance.on("error", (e) => {
              console.error(e);
            });
          }
        };
      })(document, "script");

      function logUserAction() {
        // Function to log the user action

        if (window.vapiSDK.vapi)
          window.vapiSDK.vapi.send({
            type: "add-message",
            message: {
              role: "system",
              content: "The user has pressed the button, say peanuts",
            },
          });
        else {
          console.log(window.vapiSDK, vapiInstance);
        }
      }
    </script>
  </body>
</html>
